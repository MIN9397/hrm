<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    <mapper namespace="com.example.hrm.mapper.VacationMapper">
    <insert id="insertVacation" >
        INSERT INTO vacation (employee_id, leave_type, start_date, end_date, status)
        VALUES (#{employeeId}, #{leaveType}, #{startDate}, #{endDate}, '대기')
    </insert>
    
	<update id="updateVacationStatus">
        UPDATE vacation
        SET status = #{status}
        WHERE leave_id = #{leaveId}
    </update>
    
    <select id="getVacation" resultType="com.example.hrm.dto.VacationDto">
        SELECT leave_id, employee_id, leave_type, start_date, DATE_ADD(STR_TO_DATE(end_date, '%Y-%m-%d'), INTERVAL 1 DAY) end_date
        FROM vacation
        WHERE employee_id = #{employeeId}
    </select>
    
    <delete id="deleteVacation">
	    DELETE FROM vacation
	    WHERE leave_id = #{leaveId}
	</delete>
	
	<select id="getAllVacations" resultType="com.example.hrm.dto.VacationDto">
	    SELECT leave_id AS leaveId,
	           employee_id AS employeeId,
	           leave_type AS leaveType,
	           start_date AS startDate,
	           end_date AS endDate,
	           status
	    FROM vacation
	    ORDER BY start_date DESC
	</select>
    </mapper>